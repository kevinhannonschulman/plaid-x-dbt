version: 2

models:
  - name: stg_transactions
    description: Cleaned Plaid Sandbox transaction data
    columns: 
      - name: account_id
        description: Foreign key for transactions data
        tests:
          - not_null
        relationships:
          to: ref('stg_balance')
          field: account_id
      - name: category
        description: Transaction category
      - name: subcategory
        description: Transaction subcategory
      - name: amount
        description: Transaction amount (USD)
      - name: date
        description: For pending transactions, the date that the transaction occurred; for posted transactions, the date that the transaction posted
      - name: name
        description: The merchant name or transaction description
      - name: merchant_name
        description: The merchant name, as extracted by Plaid from the name field
      - name: transaction_id
        description: Primary key for transactions data; The unique ID of the transaction
        tests:
              - unique
              - not_null 
  - name: stg_balance
    description: Cleaned Plaid Sandbox balance data
    columns:
      - name: account_id
        description: Primary key for balance data
        tests:
          - unique
          - not_null
      - name: name
        description: Name of the account, either assigned by the user or by the financial institution itself
      - name: official_name
        description: The official name of the account as given by the financial institution
      - name: int_rate
        description: interest rate for account
      - name: type
        description: type of account
        tests:
           - accepted_values:
               values: ['investment', 'credit', 'depository', 'loan', 'brokerage', 'other']
      - name: current_balance
        description: The total amount of funds in or owed by the account
      - name: available_balance
        description: The amount of funds available to be withdrawn from the account. For credit-type accounts, the available balance typically equals the limit less the current balance.
      - name: balances_limit
        description: For credit-type accounts, this represents the credit limit